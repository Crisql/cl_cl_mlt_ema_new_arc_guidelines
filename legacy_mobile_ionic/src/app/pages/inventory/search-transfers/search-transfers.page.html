<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>{{"INCOMMINGPAYMENT.SEARCHDOCS" | translate}}</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content>

    <ion-segment [(ngModel)]="currentSegment" class="fixed-segment">
        <ion-segment-button value="search">
            <ion-label>{{ "BUTTONS.BUSQUEDA" | translate }}</ion-label>
        </ion-segment-button>
        <ion-segment-button value="docList">
            <ion-label>{{ "SEARCHDOCUMENTLIST.SEARCHDOCUMENTLIST" | translate }}</ion-label>
        </ion-segment-button>
    </ion-segment>
    
    <div [ngSwitch]="currentSegment">
        <div *ngSwitchCase="'search'">

            <ion-list>
                <ion-item button detail (click)="SearchSalesPerson(null)"  *ngIf="!salesPersonSelected">
                    <ion-label>{{ 'BUTTONS.SEARCH PURCHASING MANAGER' | translate }}</ion-label>
                </ion-item>

                <ion-item-sliding *ngIf="salesPersonSelected" #slidingSalesPerson class="item-sliding-options-start">
                    <ion-item>
                        <ion-label> {{salesPersonSelected.SlpName}} </ion-label>
                    </ion-item>
                    <ion-item-options side="start">
                        <ion-item-option (click)="SearchSalesPerson(slidingSalesPerson)">
                            {{ 'BUTTONS.SEARCH PURCHASING MANAGER' | translate }}
                        </ion-item-option>
                    </ion-item-options>
                </ion-item-sliding>

                <ion-item>
                    <ion-label position="stacked"
                    >{{ 'SEARCHDOCUMENTS.DOCTYPE' | translate }}</ion-label
                    >
                    <ion-select [(ngModel)]="docTypeSelected" (ionChange)="DefineControllerToSendRequest()">
                        <ion-select-option value="13"
                        >{{ 'SEARCH TRANSFERS DOCS.TRANSFER REQUEST' | translate }}
                        </ion-select-option>
                        <ion-select-option value="14"
                        >{{ 'SEARCH TRANSFERS DOCS.STOCK TRANSFER' | translate }}
                        </ion-select-option>
                    </ion-select>
                </ion-item>

                <ion-item>
                    <ion-label position="stacked"
                    >{{ 'SEARCH TRANSFERS DOCS.DOCNUM' | translate }}</ion-label>
                    <ion-input
                            type="numbre"
                            [(ngModel)]="docNum"
                            [value]="docNum"
                    >
                    </ion-input>
                </ion-item>

                <ion-item>
                    <ion-label position="stacked"
                    >{{ 'SEARCHDOCUMENTS.DOCSTATE' | translate }}</ion-label
                    >
                    <ion-select [(ngModel)]="docState">
                        <ion-select-option
                                *ngFor="let state of docStates"
                                [value]="state.Id"
                        >{{ state.Name }}
                        </ion-select-option>
                    </ion-select>
                </ion-item>

                <ion-item>
                    <ion-label slot="start">
                        {{ 'CREATEPAYMENT.STARTDATE' | translate }}
                    </ion-label>
                    <ion-button
                            fill="clear"
                            color="primary"
                            (click)="ShowDatePicker('StartDate')"
                    >
                        {{startDate | date: 'dd/MM/y'}}<ion-icon name="calendar"></ion-icon>
                    </ion-button>
                </ion-item>

                <ion-item>
                    <ion-label slot="start">
                        {{ 'CREATEPAYMENT.ENDDATE' | translate }}
                    </ion-label>
                    <ion-button
                            fill="clear"
                            color="primary"
                            (click)="ShowDatePicker('EndDate')"
                    >
                        {{endDate | date: 'dd/MM/y'}}<ion-icon name="calendar"></ion-icon>
                    </ion-button>
                </ion-item>
            </ion-list>

            <ion-row>
                <ion-col size="12">
                    <ion-button
                            fill="solid"
                            expand="block"
                            color="primary"
                            (click)="SearchDoc()"
                    >
                        {{ 'BUTTONS.SEARCH' | translate }}
                    </ion-button>
                </ion-col>
            </ion-row>
        </div>
        <div *ngSwitchCase="'docList'">
            <ion-list>
                <ion-item *ngFor="let doc of docList" (click)="ShowDocsOptions(doc)">
                    <ion-label>
                        <p>{{ 'SEARCHDOCUMENTLIST.DOCDATE' | translate }}: {{ doc.DocDate | date:'dd/MM/yyyy h:mm a' }}</p>
                        <p>{{ 'SEARCHDOCUMENTLIST.DOCNUM' | translate }}: {{ doc.DocNum }}</p>
                        <p>{{ 'SEARCH TRANSFERS DOCS.PURCHASING MANAGER' | translate }}: {{ doc.SlpName }}</p>
                        <p>{{ 'SEARCH TRANSFERS DOCS.STATUS' | translate }}: {{ GetStatusName(doc.DocStatus) }}</p>
                    </ion-label>
                    <ion-button slot="end" color="primary" fill="clear">
                        <ion-icon name="settings-outline" size="medium"></ion-icon>
                    </ion-button>
                </ion-item>
            </ion-list>
            <ion-infinite-scroll (ionInfinite)="SearchMoreDocuments($event)">
                <ion-infinite-scroll-content></ion-infinite-scroll-content>
            </ion-infinite-scroll>
        </div>
    </div>
</ion-content>
